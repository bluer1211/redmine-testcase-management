# Redmine 測試案例管理插件 v1.6.7 發布說明

## 發布日期
2025-09-11

## 版本資訊
- **版本號**: 1.6.7
- **支援 Redmine 版本**: 6.0.6+
- **支援 Rails 版本**: 7.2.2.1+

## 主要新功能

### 1. 新增通過率欄位
在測試計劃統計頁面中新增通過率欄位，提供更詳細的測試執行分析：

- **計算公式**: 通過率 = (成功數 / (成功數 + 失敗數)) × 100%
- **多語言支援**: 英文 (Pass Rate)、日文 (合格率)、繁體中文 (通過率)
- **顯示位置**: 位於進度率欄位之後

### 2. 合計行功能
在測試計劃統計頁面底部添加合計行，顯示所有測試計劃的總體統計：

- **統計項目**: 測試案例數量、未執行、成功、失敗、成功率、進度率、通過率、預估錯誤數、發現錯誤、剩餘錯誤、修復率
- **視覺效果**: 灰色背景、粗體字體、頂部邊框分隔線
- **置中顯示**: 合計行中的 "-" 符號自動置中顯示

### 3. 問題狀態詳細顯示
在測試案例執行頁面中顯示關聯問題的詳細狀態信息：

- **顯示內容**: 問題狀態、被分派者、更新時間
- **狀態樣式**: 使用 Redmine 標準狀態顏色標籤
- **連結功能**: 被分派者名稱可點擊跳轉到使用者資料頁面
- **時間格式**: 顯示完整的日期和時間（包含時分）

## 功能改進

### 統計頁面優化
- 改善統計頁面的顯示效果和用戶體驗
- 修正測試計劃連結的 URL 生成問題
- 優化合計行的視覺呈現

### 問題關聯功能增強
- 提供更詳細的問題信息顯示
- 改善問題與測試案例執行的關聯展示
- 增強用戶對測試結果的理解

## 錯誤修復

### 1. 修復空白頁面問題
- 解決統計頁面在某些情況下顯示空白的問題
- 改善錯誤處理機制，提供更穩定的用戶體驗

### 2. 修復項目查找錯誤
- 修正 ApplicationsHelper 中的 find_project 方法語法錯誤
- 確保項目查找功能的正常運作

### 3. 修復附件警告錯誤
- 暫時停用 render_attachment_warning_if_needed 以避免 NoMethodError
- 確保測試案例執行更新功能的正常運作

## 文檔更新

### 1. 統計公式文件
創建詳細的統計計算公式文件 (`doc/STATISTICS_FORMULAS.md`)：

- **單個測試計劃統計公式**: 詳細說明每個欄位的計算方法
- **合計統計公式**: 說明合計行的計算邏輯
- **SQL 查詢結構**: 提供完整的資料庫查詢語句
- **實際範例**: 包含具體的計算範例和結果

### 2. 多語言文檔
更新語言文件，確保所有新功能都有完整的多語言支援：

- **英文 (en.yml)**: 添加 Pass Rate 翻譯
- **日文 (ja.yml)**: 添加 合格率 翻譯
- **繁體中文 (zh-TW.yml)**: 添加 通過率 翻譯

## 技術改進

### 1. 安全的數據處理
- 使用 `respond_to?` 檢查方法是否存在
- 使用 `|| 0` 處理 nil 值
- 添加 `begin/rescue` 錯誤處理機制

### 2. 視圖安全檢查
- 使用條件檢查確保合計數據存在
- 改善錯誤處理和用戶體驗

### 3. 代碼優化
- 改善代碼結構和可讀性
- 增強錯誤處理機制
- 優化性能表現

## 安裝和升級

### 新安裝
1. 下載插件文件
2. 解壓到 Redmine 的 `plugins` 目錄
3. 重啟 Redmine 服務
4. 在項目設定中啟用「測試案例管理」模組

### 從 v1.6.6 升級
1. 備份現有數據
2. 替換插件文件
3. 重啟 Redmine 服務
4. 新功能將自動可用

## 相容性

- **Redmine**: 6.0.6+
- **Rails**: 7.2.2.1+
- **Ruby**: 3.0+
- **資料庫**: MySQL 5.7+, PostgreSQL 10+, SQLite 3.8+

## 回報問題

如果您在使用過程中遇到任何問題，請通過以下方式回報：

- **GitHub Issues**: [插件 GitHub 頁面]
- **電子郵件**: [開發者聯繫方式]

## 致謝

感謝所有用戶的反饋和建議，這些改進都基於實際使用需求。特別感謝：

- 原始作者：優人 岡田 (SENA Networks Inc.)
- 延伸開發：Jason Liu (@bluer1211)
- 所有測試用戶和貢獻者

---

**注意**: 本版本包含多項重要功能改進和錯誤修復，建議所有用戶升級到最新版本以獲得最佳使用體驗。
